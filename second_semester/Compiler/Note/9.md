## Binding and Scopes

### Names and Variables

---

#### Introduction

1. å‘½ä»¤å¼èªè¨€æ˜¯ **von Neumann architecture**
   * è©²æ¶æ§‹åŒ…æ‹¬è¨˜æ†¶é«”èˆ‡è™•ç†å™¨
   * ç¨‹å¼èªè¨€é€éæ¨¡æ“¬æ­¤æ¶æ§‹é‹ä½œï¼Œè®“è®Šæ•¸å°æ‡‰åˆ°è¨˜æ†¶é«”å–®å…ƒï¼Œç¨‹å¼æŒ‡ä»¤å°æ‡‰åˆ°è™•ç†å™¨æ“ä½œã€‚
2. è®Šæ•¸çš„è¨­è¨ˆèˆ‡ç®¡ç†ï¼š
   * Scope
   * Lifetime
   * Type Checking
   * Initialization
   * Type Compatibility

---

### Names

1. **Design issues**
   1. æ˜¯å¦å€åˆ†å¤§å°å¯«ï¼Ÿ
   2. ç‰¹æ®Šå­—æ˜¯å¦ç‚ºä¿ç•™å­—æˆ–é—œéµå­—
   3. åç¨±æ˜¯å¦è¶³å¤ å…·æœ‰èªæ„
2. **example**
   1. **C99**: ç„¡é•·åº¦é™åˆ¶ï¼Œä½†åªæœ‰å‰ 63 å€‹å­—å…ƒæœ‰æ„ç¾©
   2. **C# / Java**: ç„¡é•·åº¦é™åˆ¶ï¼Œæ‰€æœ‰å­—å…ƒéƒ½æœ‰æ•ˆ
   3. **C++**: ç„¡æ˜æ–‡é™åˆ¶ï¼Œä½†ç·¨è­¯å™¨å¯¦ä½œä¸Šå¸¸æœ‰ä¸Šé™
3. **Special Characters**
   1. **PHP**: begin with **$**
   2. **Perl**: ç”¨ **$, @, %** ç­‰å­—å…ƒè¡¨ç¤ºè®Šæ•¸é¡å‹ 
   3. **Ruby**: **@** è¡¨ç¤ºç«‹å³è®Šæ•¸ã€**@@** è¡¨ç¤ºé¡åˆ¥è®Šæ•¸
   4. Disadvantage -> readability: C-based are case sensitive
4. Spectial words
   1. **keyword**: special only in certain contexts.
   2. **reserved word**: is a special word that cannot be used as a user-defined name.

---

### Variable

1. Name, Address, Value, Type, Lifetime, Scope
2. I-value: è®Šæ•¸çš„è¨˜æ†¶é«”ä½å€
3. r-value: è®Šæ•¸çš„å€¼
4. Abstract memory cell = the physical cell or collection of cells associated with a variable.

---

### Binding

1. å°‡è®Šæ•¸ç¶å®šåˆ°ä¸€å€‹å‹åˆ¥ã€‚

2. å°‡æ“ä½œç¬¦ + ç¶å®šç‚ºã€æ•´æ•¸åŠ æ³•ã€æˆ–ã€å­—ä¸²ä¸²æ¥ã€

3. Binding time

4. | **é¡å‹**            | **æ™‚æ©Ÿ**   | **ç‰¹æ€§**                     |
   | ------------------- | :--------- | ---------------------------- |
   | **Static Binding**  | åŸ·è¡Œå‰å®Œæˆ | ä¸€æ—¦æ¨æ–·å‡ºä¾†å°±ä¸èƒ½è®Šï¼Œæ•ˆç‡é«˜ |
   | **Dynamic Binding** | åŸ·è¡Œæ™‚ç™¼ç”Ÿ | å¯å½ˆæ€§æ”¹è®Šï¼Œä½†æˆæœ¬é«˜         |

   Possible binding times

   | **ç¶å®šéšæ®µ**                     | **èªªæ˜**                   | **ç¯„ä¾‹**                            |
   | -------------------------------- | -------------------------- | ----------------------------------- |
   | **Language Design Time**         | æ±ºå®šç¬¦è™Ÿæ„ç¾©               | + è¡¨ç¤ºåŠ æ³•                          |
   | **Language Implementation Time** | æ±ºå®šå‹åˆ¥å¯¦ä½œæ–¹å¼           | æµ®é»æ•¸å¦‚ä½•è¡¨ç¤º                      |
   | **Compile Time**                 | æ±ºå®šè®Šæ•¸å‹åˆ¥               | int x; in C                         |
   | **Link/Load Time**               | æ±ºå®šè¨˜æ†¶é«”ä½ç½®             | C çš„ static/global è®Šæ•¸é…ç½®         |
   | **Runtime**                      | æ±ºå®šå¯¦é«”è¨˜æ†¶é«”ä½ç½®èˆ‡å¯¦éš›å€¼ | C çš„ local è®Šæ•¸é€²å…¥å‡½å¼æ‰åˆ†é…è¨˜æ†¶é«” |

---

### Declarations

1. Explicit : æ˜ç¢ºæŒ‡å®šè®Šæ•¸å‹åˆ¥ã€‚

   ```cpp
   int x = 5;
   string name = "Steven"
   ```

2. Implicit : ç”±èªè¨€è‡ªå‹•æ¨æ–·æˆ–é è¨­å‹åˆ¥ã€‚
   1. Basic
   2. Perl
   3. Ruby
   4. Javascript
   5. PHP

---

### Type Inference

1. ç·¨è­¯å™¨æ ¹æ“šä¸Šä¸‹æ–‡è‡ªå‹•åˆ¤æ–·è®Šæ•¸çš„å‹åˆ¥ï¼Œè€Œä¸éœ€æ˜ç¢ºæŒ‡å®šã€‚

2. | **èªè¨€**              | **èªªæ˜**                             |
   | --------------------- | ------------------------------------ |
   | **C#**                | ä½¿ç”¨ var é—œéµå­—èˆ‡åˆå§‹å€¼è‡ªå‹•æ¨æ–·å‹åˆ¥  |
   | **Visual Basic 9+**   | æ”¯æ´å‹åˆ¥æ¨è«–                         |
   | **ML / Haskell / F#** | é«˜éšèªè¨€ï¼Œå‹åˆ¥æ¨è«–æ˜¯èªè¨€è¨­è¨ˆæ ¸å¿ƒä¹‹ä¸€ |

---

### Dynamic Type Binding

1. ç¨‹å¼åŸ·è¡ŒæœŸé–“æ‰æ±ºå®šè®Šæ•¸çš„å‹åˆ¥ï¼Œä¸¦ä¸”å‹åˆ¥å¯ä»¥æ”¹è®Šã€‚

   ```javascript
   let x = [1, 2, 3];
   x = 3.14
   ```

1. **Language**:
   1. JavaScript
   2. Python
   3. PHP
   4. C#
   5. Ruby
2. éˆæ´» -> æ”¯æ´é€šç”¨å‡½å¼ -> å¿«é€ŸåŸå‹è¨­è¨ˆ
3. æ•ˆç‡ä½ã€ç·¨è­¯å™¨ç„¡æ³•åœ¨åŸ·è¡Œå‰æª¢æŸ¥å‹åˆ¥éŒ¯èª¤

---

### Storage Binding & Lifetime

1. **Allocation** : å°‡ä¸€å€‹è®Šæ•¸ç¶å®šåˆ°ä¸€å¡Šè¨˜æ†¶é«”ç©ºé–“ã€‚
2. **Deallocation** : å°‡è¨˜æ†¶é«”æ­¸é‚„çµ¦ç³»çµ±æˆ–è¨˜æ†¶é«”æ± ã€‚
3. **Lifetime** : è®Šæ•¸çš„å­˜æ´»æœŸæ˜¯ä»–èˆ‡è¨˜æ†¶é«”ç©ºé–“ç¶å®šåœ¨ä¸€èµ·çš„é‚£æ®µæ™‚é–“ã€‚

---

### Categories of Variables by Lifetimes

1. **Static** : åŸ·è¡Œå‰å°±å·²åˆ†é…è¨˜æ†¶é«” ( load time )ã€‚

   ```cpp
   void func(){
     static int count = 0;
     count++;
     std::cout << count << '\n';
   }
   ```

   > efficiency
   >
   > lack of flexibility ( no recursion )

2. **Stack-Dynamic** :  

   1. å‘¼å«å‡½å¼æ™‚æ‰åˆ†é…è¨˜æ†¶é«”ï¼ˆ run time stack ï¼‰ã€‚

   2. å‡½å¼çµæŸæ™‚è‡ªå‹•é‡‹æ”¾ã€‚

   3. å‹åˆ¥èˆ‡å…¶ä»–å±¬æ€§åœ¨ç·¨è­¯æœŸå°±æ±ºå®šï¼Œåªæœ‰åœ°å€æ˜¯åœ¨åŸ·è¡ŒæœŸç¶å®šçš„ã€‚

      > æ”¯æ´éè¿´ã€ç¯€çœè¨˜æ†¶é«”ã€‚
      >
      > æ¯æ¬¡å‘¼å«éƒ½æœ‰é¡å¤–çš„è¨˜æ†¶é«”åˆ†é…èˆ‡é‡‹æ”¾æˆæœ¬ã€é–“æ¥å­˜å–æ•ˆç‡ä½ï¼ˆéœ€é€é stack frameï¼‰ã€‚

3. **Explicit Heap-Dynamic**

   1. æ˜ç¢ºçš„æŒ‡ä»¤ï¼Œåœ¨åŸ·è¡Œæ™‚å‹•æ…‹é…ç½®èˆ‡é‡‹æ”¾ã€‚

      ```cpp
      int *p = new int(10);
      delete p;
      ```

   2. é«˜å½ˆæ€§ã€æ•ˆç‡ä½

4. **Implicit Heap-Dynamic**

   1. é è³¦å€¼èªå¥è‡ªå‹•åˆ†é…æˆ–é‡‹æ”¾è¨˜æ†¶é«”ï¼Œä¸éœ€è¦æ˜ç¢ºèª¿ç”¨ **new/delete**ã€‚

      > variables : **APL**
      >
      > strings & arrays : **Perl, JavaScript and PHP**

      ```javascript
      let x = "hello";   // x æ˜¯ string
      x = [1, 2, 3];     // x è®Šæˆ arrayï¼Œè‡ªå‹•é…ç½®ä¸åŒå‹åˆ¥èˆ‡ç©ºé–“
      ```

   1. æ¥µéˆæ´»ã€é©åˆå¿«é€Ÿé–‹ç™¼èˆ‡è…³æœ¬èªè¨€ã€æ•ˆç‡ä½ã€å¯æ§æ€§å·®ã€‚

   | **é¡å‹**                  | **åˆ†é…æ™‚æ©Ÿ**       | **ç¨‹å¼å“¡æ§åˆ¶ï¼Ÿ** | **å„²å­˜å€**   | **èªè¨€ç¯„ä¾‹**     | **å„ªé»** | **ç¼ºé»**   |
   | ------------------------- | ------------------ | ---------------- | ------------ | ---------------- | -------- | ---------- |
   | **Static**                | è¼‰å…¥æ™‚             | å¦               | Data segment | C/C++ static     | æ•ˆç‡é«˜   | ç„¡éè¿´     |
   | **Stack-Dynamic**         | åŸ·è¡Œæ™‚ã€é€²å…¥å€å¡Šæ™‚ | å¦               | Stack        | C, Java local    | æ”¯æ´éè¿´ | åˆ†é…é–‹éŠ·   |
   | **Explicit Heap-Dynamic** | åŸ·è¡Œæ™‚             | æ˜¯               | Heap         | C++ (new/delete) | éˆæ´»     | æ˜“æ¼è¨˜æ†¶é«” |
   | **Implicit Heap-Dynamic** | åŸ·è¡Œæ™‚             | å¦               | Heap         | JS, PHP          | è¶…å½ˆæ€§   | é›£é™¤éŒ¯     |

---

### Scopes

   1. Local Variables : åœ¨æŸå€‹å‡½å¼æˆ–å€å¡Šå…§éƒ¨å®£å‘Šï¼Œåªåœ¨é‚£è£¡æœ‰æ•ˆã€‚

   2. Nonlocal Variables : åœ¨å¤–éƒ¨å®£å‘Šï¼Œä½†æ˜¯é€™è£¡å¯è¦‹ã€‚

   3. Global Variables : åœ¨æ‰€æœ‰å‡½å¼å¤–éƒ¨å®£å‘Šï¼Œæ•´å€‹ç¨‹å¼éƒ½èƒ½çœ‹åˆ°

      ```cpp
      int globalX = 1; // global ä¹Ÿæ˜¯ nonlocal
      
      void outer() {
          int outerX = 2; // outerX æ˜¯ outer çš„ local
      
          void inner() {
              std::cout << outerX;  // å° inner ä¾†èªªï¼ŒouterX æ˜¯ nonlocal
              std::cout << globalX; // å° inner ä¾†èªªï¼ŒglobalX ä¹Ÿæ˜¯ nonlocalï¼ˆæ›´å¤–å±¤ï¼‰
          }
      }
      ```

   4. ä¸€å€‹èªè¨€çš„ä½œç”¨åŸŸè¦å‰‡ï¼ˆ scope rulesï¼‰ï¼Œæ±ºå®šäº†å°åç¨±çš„åƒè€ƒï¼Œè¦ç¶å®šåˆ°å“ªå€‹è®Šæ•¸ä¸Šã€‚

   5. å¦‚æœåŒåè®Šæ•¸åœ¨ä¸åŒç¯„åœä¸­å‡ºç¾ï¼Œæœƒç”¢ç”Ÿã€è®Šæ•¸é®è”½ã€(hiding)ã€‚ 

---

### Static Scope

1. æ ¹æ“šç¨‹å¼ç¢¼çš„æ–‡å­—ä½ç½®ä¾†æ±ºå®šè®Šæ•¸åç¨±æ‰€æŒ‡çš„è®Šæ•¸ï¼ˆä¹Ÿå°±æ˜¯è®Šæ•¸ç¶å®šï¼‰ã€‚

   > ä½¿ç”¨éœæ…‹æœå°‹è¦å‰‡

   1. å…ˆå¾ç›®å‰çš„å€å¡Šå¾€å¤–æ‰¾
   2. å¦‚æœæ‰¾ä¸åˆ°ï¼Œå†åˆ°å¤–å±¤å€å¡Šæœå°‹ã€‚
   3. ä¸€è·¯å¾€å¤–æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°è®Šæ•¸ç‚ºæ­¢ã€‚

2. Enclosing static scopes = **static ancestors**

3. the nearest static ancestor = **static parent**

4. **C / C++ / Java / Python / JavaScript / Ada / Scheme / F#** ç­‰ä¸»æµç¨‹èªè¨€

   ```cpp
   int x = 1;
   void outer() {
       int x = 2;
       void inner() {
           std::cout << x;  // static scope â†’ è¼¸å‡º 2ï¼ˆæ‰¾æœ€è¿‘çš„ï¼‰
       }
       inner();
   }
   ```

---

### Block

1. åœ¨ç¨‹å¼ä¸­å»ºç«‹æ–°çš„éœæ…‹ä½œç”¨åŸŸçš„ä¸€ç¨®æ–¹å¼ã€‚

   > block scope { }
   >
   > -- from ALOGOL 60

   

   | **æ”¯æ´**      | **èªªæ˜**                                                     |
   | ------------- | ------------------------------------------------------------ |
   | **C / C++**   | æ”¯æ´ block scopeï¼ˆåˆæ³•ï¼‰                                     |
   | **Java / C#** | é›–ç„¶èªæ³•ä¸Šå…è¨±ï¼Œä½† **å®¹æ˜“å‡ºéŒ¯ã€ä¸æ¨è–¦ä½¿ç”¨**ï¼Œå¦‚åœ¨åŒä¸€ä½œç”¨åŸŸä¸­é‡è¤‡å®šç¾©è®Šæ•¸ |

   ```cpp
   void sub() {
       int count;
       while (...) {
           int count;   // âš ï¸ é€™è£¡é‡æ–°å®£å‘Šäº†ä¸€å€‹æ–°çš„ countï¼ˆé®è”½å¤–å±¤ï¼‰
           count++;
           ...
       }
       ...
   }
   ```

---

### Declaration Order

1. åœ¨ä¸åŒèªè¨€ä¸­ï¼Œå€åŸŸè®Šæ•¸çš„ä½œç”¨åŸŸèµ·é»å¯èƒ½å› ç‚ºè®Šæ•¸å®£å‘Šçš„ä½ç½®ä¸åŒè€Œæœ‰æ‰€å·®ç•°ã€‚

   1. **C99, C++, Java** :
      1.  è®Šæ•¸å¯ä»¥åœ¨å€å¡Šä¸­ä»»ä½•ä¸€å€‹ä½ç½®å®£å‘Šã€‚
      2. ä½œç”¨åŸŸå¾å®£å‘Šé‚£ä¸€è¡Œé–‹å§‹ï¼Œåˆ°è©²å€å¡ŠçµæŸç‚ºæ­¢ã€‚

   ```cpp
   void foo() {
       int x = 1;
       if (x > 0) {
           int x = 2;  // x çš„ä½œç”¨åŸŸå¾é€™ä¸€è¡Œé–‹å§‹ï¼Œå…§å±¤å¯é®è”½å¤–å±¤
           ...
       }
   }
   ```

   2. **C#** : 

      1. è®Šæ•¸çš„ä½œç”¨æµ´å®¤æ•´å€‹å€å¡Šï¼ˆå¾{ åˆ° } )

   ```c#
   void Foo() {
	    {
           int x = 10;
           {
               int x = 20;  // âŒ éŒ¯èª¤ï¼šx å·²åœ¨å¤–å±¤å€å¡Šå®£å‘Š
           }
       }
   }
   ```
   3. **for** è¿´åœˆçš„è®Šæ•¸å®£å‘Š
   
      1. **C++, Java, C#** éƒ½æ”¯æ´åœ¨ for è£¡ç›´æ¥å®£å‘Šè®Šæ•¸ï¼Œä¸”è®Šæ•¸çš„ä½œç”¨åŸŸåƒ…é™æ–¼ for è¿´åœˆæœ¬é«”ã€‚
   
   ```cpp
   for (int i = 0; i < 10; ++i) {
       // i åœ¨é€™è£¡æœ‰æ•ˆ
   }
   // i åœ¨é€™è£¡ç„¡æ•ˆï¼ˆC++, Javaï¼‰
   ```
---

### Global Scope

1. åœ¨æ‰€æœ‰å‡½å¼ã€å€å¡Šå¤–éƒ¨å®£å‘Šçš„è®Šæ•¸ï¼Œèƒ½è¢«æ•´å€‹ç¨‹å¼æˆ–æ¨¡çµ„ä¸­æ‰€æœ‰ç¨‹å¼å–®å…ƒå­˜å–ã€‚

   | **èªè¨€**   | **èªªæ˜**                                                  |
   | ---------- | --------------------------------------------------------- |
   | **C, C++** | æ”¯æ´å®Œæ•´çš„å…¨åŸŸè®Šæ•¸èˆ‡å‡½å¼å®šç¾©                              |
   | **PHP**    | å¤šæ®µ HTML + PHP æ··åˆï¼Œè®Šæ•¸å¯ä»¥è·¨æ®µå­˜å–ï¼ˆéœ€è²æ˜ç‚º globalï¼‰ |
   | **Python** | æ¨¡çµ„å±¤ç´šè®Šæ•¸é è¨­ç‚ºå…¨åŸŸï¼Œä½†åœ¨å‡½å¼ä¸­è¦ global è²æ˜æ‰èƒ½è³¦å€¼  |

   1. **C/C++** å¯åœ¨æ‰€æœ‰å‡½å¼å¤–éƒ¨å®£å‘Šè®Šæ•¸æˆ–å‡½å¼ï¼š

      ```cpp
      int globalX = 10;
      void foo(){
      	  std::cout << globalX; // å¯ä»¥ä½¿ç”¨ globalX
      }
      ```

   2. **C/C++** å€åˆ† **å®£å‘Šï¼ˆdeclarationï¼‰** å’Œ **å®šç¾©ï¼ˆdefinitionï¼‰**ï¼š

      ```cpp
      extern int x;   // å®£å‘Šï¼šå‘Šè¨´ç·¨è­¯å™¨ x å­˜åœ¨ï¼ˆä½†ä¸é…ç½®è¨˜æ†¶é«”ï¼‰
      int x = 5;      // å®šç¾©ï¼šçœŸæ­£é…ç½®è¨˜æ†¶é«”
      ```

   3. **PHP** åœ¨å‡½å¼å¤–éƒ¨å®£å‘Šçš„è®Šæ•¸æœƒè®Šæˆå…¨åŸŸè®Šæ•¸ï¼Œè‹¥è¦åœ¨å‡½å¼å…§ä½¿ç”¨ï¼Œéœ€æ˜ç¢ºæ¨™ç¤º **global** æˆ–ä½¿ç”¨ **$GLOBALS** é™£åˆ—

      > ä¹Ÿå°±æ˜¯ä¸­é–“çš„å‡½å¼å€å¡Šä¸èƒ½ç›´æ¥çœ‹åˆ°å…¨åŸŸè®Šæ•¸

      ```php
      $globalVar = 5;
      
      function foo() {
          global $globalVar;
          echo $globalVar;
      }
      ```

   4. **Python** åœ¨å‡½å¼å¤–å®šç¾©çš„è®Šæ•¸é è¨­ç‚ºå…¨åŸŸï¼Œä½†è¦åœ¨å‡½å¼ä¸­ä¿®æ”¹ä»–çš„å€¼ï¼Œå¿…é ˆä½¿ç”¨ global é—œéµå­—ã€‚

      > å…¨åŸŸè®Šæ•¸å¯ä»¥åœ¨å‡½å¼ä¸­è®€å–ï¼Œä½†æ˜¯è‹¥è¦ä¿®æ”¹å°±è¦åŠ ä¸Š **global**ã€‚
      >
      
      ```python
      x = 5
      
      def foo():
          global x
          x = 10  # ä¿®æ”¹å…¨åŸŸè®Šæ•¸
      ```
      
   
   | **èªè¨€** | **å…¨åŸŸè®Šæ•¸åœ¨å‡½å¼ä¸­å¯è®€ï¼Ÿ** | **å¯æ”¹ï¼Ÿ**           | **æ”¹è®Šæ–¹å¼**                    |
   | -------- | -------------------------- | -------------------- | ------------------------------- |
   | PHP      | âŒ ä¸èƒ½ç›´æ¥è®€               | âŒ ä¸èƒ½ç›´æ¥æ”¹         | è¦ç”¨ global $x æˆ– $GLOBALS["x"] |
   | Python   | âœ… å¯è®€                     | âŒ ä¸åŠ  global ä¸èƒ½æ”¹ | è¦ç”¨ global x                   |

---

### Evaluation of Static Scoping

1. å¤§å¤šæ•¸æƒ…æ³ä¸‹ï¼Œéœæ…‹ä½œç”¨åŸŸè¡¨ç¾å¾—å¾ˆå¥½ï¼Œå› ç‚ºå®ƒè®“ç¨‹å¼**å®¹æ˜“ç†è§£èˆ‡é æ¸¬**ã€‚

2. å¤ªå®¹æ˜“å–å¾—å¤–éƒ¨è®Šæ•¸ï¼ˆtoo much accessï¼‰

3. ç¨‹å¼çµæ§‹å®¹æ˜“ç ´å£ï¼ˆstructure destroyed as program evolvesï¼‰

4. å­ç¨‹å¼æœƒå¾€å¤–ç§»ï¼ˆSubprograms gravitate toward globalï¼‰
     - ç‚ºäº†è®“æŸäº›å‡½å¼å¯ä»¥å…±ç”¨è®Šæ•¸ï¼Œé–‹ç™¼è€…æœƒæŠŠå‡½å¼ã€Œç§»å‡ºã€åŸæœ¬å·¢ç‹€ä½ç½®
     - å°è‡´å¤±å»éœæ…‹ä½œç”¨åŸŸåŸæœ¬çš„çµæ§‹æ€§å¥½è™•

> éœæ…‹ä½œç”¨åŸŸèƒ½å¤ æå‡**å¯é æ¸¬æ€§ã€å¯è®€æ€§èˆ‡å‹åˆ¥å®‰å…¨**ï¼Œä½†åœ¨å¤§å‹ç¨‹å¼ä¸­å®¹æ˜“ç”¢ç”Ÿ**éåº¦å…±ç”¨ã€è€¦åˆéé«˜ã€çµæ§‹é¬†æ•£**ç­‰å•é¡Œã€‚

---

### Dynamic vs, Static Scoping

1. **Dynamic Scope** æ˜¯æ ¹æ“šå‡½å¼å‘¼å«é †åºï¼ˆ **calling squecnce** ï¼‰ä¾†æ±ºå®šè®Šæ•¸åç¨±å°æ‡‰å“ªå€‹è®Šæ•¸çš„ä½œç”¨æ–¹å¼ï¼Œè€Œä¸æ˜¯æ ¹æ“šç¨‹å¼ç¢¼çš„å·¢ç‹€çµæ§‹ï¼ˆ **textual layout** ï¼‰ã€‚

2. **Dynamic Scope** References to variables are connected to declarations by searching back through the chain of subprogram calls that forced execution to this point.

   > è®Šæ•¸ç¶å®šæœƒæ ¹æ“šç›®å‰çš„åŸ·è¡Œéç¨‹å¾€å›æ‰¾èª°å‘¼å«èª°ä¾†æ±ºå®šè¦ç”¨å“ªå€‹è®Šæ•¸ï¼Œä¸¦ä¸æ˜¯çœ‹èª°åŒ…ä½èª°ï¼Œè€Œæ˜¯çœ‹åŸ·è¡Œçš„å‡½å¼å‘¼å«å †ç–Šã€‚

   - **Static Scope exampleï¼š**

   ```javascript
   function big() {
       var x = 3;              // A: x åœ¨ big è£¡ = 3
       function sub1() {
           var x = 7;          // B: x åœ¨ sub1 è£¡ = 7
           sub2();             // å‘¼å« sub2
       }
       function sub2() {
           var y = x;          // ğŸ”¥ sub2 è£¡æ²’æœ‰ xï¼Œè¦ã€Œæ‰¾ xã€
           console.log(y);     // å®ƒæœƒè¼¸å‡ºä»€éº¼ï¼Ÿ
       }
       sub1();                 // å¾ big å‘¼å« sub1ï¼Œsub1 å†å‘¼å« sub2
   }
   big();
   ```

   output : 

   ```javascript
   3
   ```

   - **Dynamic Scope example :** 

   ```bash
   #!/bin/bash
   
   function big() {
     local x="under big"
     function sub1() {
       local x="under sub1"
       sub2
     }
     function sub2() {
       echo "x is $x"
     }
     sub1
   }
   big
   ```

   output : 

   ```bash
   x is under sub1
   ```

| **é …ç›®**           | **ğŸ”µ Static Scopeï¼ˆéœæ…‹ä½œç”¨åŸŸï¼‰**          | **ğŸ”´ Dynamic Scopeï¼ˆå‹•æ…‹ä½œç”¨åŸŸï¼‰**               |
| ------------------ | ----------------------------------------- | ----------------------------------------------- |
| ğŸ“Œ æ±ºå®šè®Šæ•¸ç¶å®šä¾æ“š | ä¾ **ç¨‹å¼ç¢¼çµæ§‹**ï¼ˆå·¢ç‹€é—œä¿‚ï¼‰             | ä¾ **å‡½å¼å‘¼å«é †åºï¼ˆCall Stackï¼‰**               |
| ğŸ“ ç¶å®šæ™‚æ©Ÿ         | ç·¨è­¯æ™‚å°±æ±ºå®šå¥½                            | åŸ·è¡Œæ™‚æ‰æ±ºå®š                                    |
| ğŸ” æ‰¾è®Šæ•¸çš„æ–¹æ³•     | å¾å®šç¾©è™•å‘**å¤–å±¤ç¨‹å¼ç¢¼å€å¡Š**æ‰¾            | å¾åŸ·è¡Œæ™‚çš„**å‘¼å«éˆå¾€å›æ‰¾**                      |
| âœ… å¯è®€æ€§           | é«˜ï¼ˆå¯é æ¸¬ï¼‰                              | ä½ï¼ˆé›£è¿½è¹¤ä¾†æºï¼‰                                |
| âŒ ç¼ºé»             | æ˜“å…±ç”¨éå¤šè®Šæ•¸ã€è€¦åˆé«˜                    | é›£éœæ…‹æª¢æŸ¥ï¼Œdebug å›°é›£                          |
| ğŸ§ª éœæ…‹ç¯„ä¾‹çµæœ     | sub2() â†’ æ‰¾åˆ° big çš„ xï¼ˆå› ç‚ºå¯«åœ¨ big è£¡ï¼‰ | sub2() â†’ æ‰¾åˆ° sub1 çš„ xï¼ˆå› ç‚ºæ˜¯å¾ sub1 å‘¼å«ï¼‰   |
| ğŸ’¬ ä»£è¡¨èªè¨€         | C, C++, Java, Python, JavaScriptâ€¦         | æ—©æœŸ Lispã€Bash shellï¼ˆå‡½å¼ç¯„åœï¼‰ã€Perlï¼ˆéƒ¨åˆ†ï¼‰ |

---

### Scope & Lifetime

1. Scope : ç¨‹å¼ä¸­å“ªå€‹å€åŸŸèƒ½çœ‹è¦‹è®Šæ•¸ã€‚æ˜¯èªæ„å±¤é¢ï¼Œå’Œèªæ³•çµæ§‹æœ‰é—œã€‚
2. Lifetime : è®Šæ•¸å¯¦éš›åœ¨è¨˜æ†¶é«”ä¸­å­˜æ´»å¤šä¹…ã€‚æ˜¯åŸ·è¡Œå±¤é¢ï¼Œå’Œè¨˜æ†¶é«”åˆ†é…æœ‰é—œã€‚
